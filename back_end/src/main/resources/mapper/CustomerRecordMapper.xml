<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.model.mapper.CustomerRecordMapper">
    <resultMap id="CustomerRecordResult" type="com.example.entity.CustomerRecord">
        <id column="record_id" property="recordId"/>
        <result column="record_title" property="recordTitle"/>
        <result column="record_type" property="recordType"/>
        <result column="record_time" property="recordTime"/>
        <result column="record_content" property="recordContent"/>
        <result column="cus_id" property="cusId"/>
        <result column="emp_id" property="empId"/>
    </resultMap>

    <insert id="addCustomerRecord" parameterType="com.example.entity.CustomerRecord">
        INSERT INTO customer_record
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="recordTitle != null and recordTitle != ''">
                record_title,
            </if>
            <if test="recordType != null and recordType != ''">
                record_type,
            </if>
            <if test="recordTime != null">
                record_time,
            </if>
            <if test="recordContent != null and recordContent != ''">
                record_content,
            </if>
            <if test="cusId != null">
                cus_id,
            </if>
            <if test="empId != null">
                emp_id,
            </if>
        </trim>
        <trim prefix="VALUES (" suffix=")" suffixOverrides=",">
            <if test="recordTitle != null and recordTitle != ''">
                #{recordTitle},
            </if>
            <if test="recordType != null and recordType != ''">
                #{recordType},
            </if>
            <if test="recordTime != null">
                #{recordTime},
            </if>
            <if test="recordContent != null and recordContent != ''">
                #{recordContent},
            </if>
            <if test="cusId != null">
                #{cusId},
            </if>
            <if test="empId != null">
                #{empId},
            </if>
        </trim>
    </insert>

    <select id="listCustomerRecord" resultMap="CustomerRecordResult">
        SELECT record_id,record_title,record_type,record_time,record_content,cus_id,emp_id
        FROM customer_record
        <where>
            <if test="recordTitle != null and recordTitle != ''">
                AND record_title LIKE CONCAT('%',#{recordTitle},'%')
            </if>
            <if test="recordType != null and recordType != ''">
                AND record_type LIKE CONCAT('%',#{recordType},'%')
            </if>
            <if test="cusId != null">
                AND cus_id = #{cusId}
            </if>
            <if test="empId != null">
                AND emp_id = #{empId}
            </if>
        </where>
        ORDER BY record_time DESC
    </select>
</mapper>