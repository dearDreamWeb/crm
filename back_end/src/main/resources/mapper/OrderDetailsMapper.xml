<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.model.mapper.SzOrderDetailsMapper">
    <resultMap id="OrdandOrdDetResult" type="com.example.entity.request.SzOrderDetails">
        <id property="odetId" column="odet_id"/>
        <result property="odetBuynum" column="odet_buynum"/>
        <result property="odetBuymoney" column="odet_buymoney"/>
        <result property="ordId" column="ord_id"/>
        <result property="productId" column="product_id"/>
    </resultMap>

    <resultMap id="OrdandOrdDet_Result" type="com.example.entity.request.SzOrderDetails">
        <id property="odetId" column="odet_id"/>
        <result property="odetBuynum" column="odet_buynum"/>
        <result property="odetBuymoney" column="odet_buymoney"/>
        <result property="ordId" column="ord_id"/>
        <result property="productId" column="product_id"/>
        <association property="szOrder" resultMap="szOrder"/>
    </resultMap>

    <resultMap id="szOrderResult" type="com.example.entity.request.SzOrder">
        <id property="ordId" column="ord_id"/>
        <result property="ordTheme" column="ord_theme"/>
        <result property="ordState" column="ord_state"/>
        <result property="ordHead" column="ord_head"/>
        <result property="ordTotalmoney" column="ord_totalmoney"/>
        <result property="ordStarttime" column="ord_starttime"/>
        <result property="ordDealtime" column="ord_dealtime"/>
        <result property="ordFahuotime" column="ord_fahuotime"/>
        <result property="ordHuikuanmoney" column="ord_huikuanmoney"/>
        <result property="ordConsignee" column="ord_consignee"/>
        <result property="ordProvince" column="ord_province"/>
        <result property="ordCity" column="ord_city"/>
        <result property="ordCountry" column="ord_country"/>
        <result property="ordDetail" column="ord_detail"/>
        <result property="ordPhone" column="ord_phone"/>
        <result property="ordCreatetime" column="ord_createtime"/>
        <result property="ordDelete" column="ord_delete"/>
        <result property="cusId" column="cus_id"/>
        <result property="offerId" column="offer_id"/>
    </resultMap>

    <!--订单和订单详情-->
    <select id="listOrderANDOrderDet" resultMap="OrdandOrdDetResult">
        SELECT odet_id,odet_buynum,odet_buymoney,ord_id,product_id FROM sz_order_details WHERE ord_id=#{odetId}
    </select>
    <!--增-->
    <insert id="addOrderANDOrderDet" parameterType="java.util.List">
        <selectKey keyProperty="odetId" keyColumn="odet_id" resultType="Integer" order="AFTER">
            SELECT last_insert_id();
        </selectKey>
        insert into sz_order_details(odet_buynum, odet_buymoney, ord_id, product_id) VALUES
        (#{odetBuynum},#{odetBuymoney},#{ordId},#{productId})
    </insert>

    <insert id="addOrderDetail" parameterType="com.example.entity.request.SzOrderDetails">
        insert into sz_order_details(odet_buynum, odet_buymoney, ord_id, product_id) VALUES
        (#{odetBuynum},#{odetBuymoney},#{ordId},#{productId})
    </insert>
</mapper>